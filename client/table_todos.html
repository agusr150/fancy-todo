<!DOCTYPE html>
<html>
<head>
<title>Page Show All/title>
</head>

<body>

<h1>Table</h1>

<button><a href="create_todos.html">Add Todo</a></button>

<table id="list-todos" class="table">
    
        <tr>
            <th>Title</th>
            <th>Description</th>
            <th>Status</th>
            <th>Due Date</th>
            <th>Creator</th>
          </tr>
</table>

</body>

<!-- <script type="text/javascript" src="https://cdn.datatables.net/v/dt/dt-1.10.20/datatables.min.js"></script> -->

<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
  <script>
    $.ajax({
        type: "GET", 
        url: "http://localhost:3000/todos", 
        headers: {"token": localStorage.getItem('token')},
        success: function(result){
                console.log(result.response)
                for (let i=0; i<result.response.length; i++){
                    var data=result.response[i]
                $('#list-todos').append(`
                <tr>
                    <th id="dataId" hidden>${data.id}</th>
                    <th id="dataTitle_${i}">${data.title}</th>
                    <th id="dataDescription_${i}">${data.description}</th>
                    <th id="dataStatus_${i}">${data.status}</th>
                    <th id="dataDueDate_${i}">${data.due_date}</th>
                    <th id="dataUserId_${i}">${data.userId}</th>
                    <th>
                        <input onClick="window.location.href='edit_todos.html'" id="todo-del" type="button" value="Edit">
                        <input onClick="window.location.href='table_todos.html'" id="todo-del" type="button" value="Delete">
                    </th>
                </tr>
                `)
                }
        },
        error: function(err){
            console.log(err)
        }
    })

    $(`#todo-del`).click(function(){
        var id = $("#dataId").val()
        console.log(id)
        $.ajax({
            type: "DELETE", 
            url: "http://localhost:3000/todos/"+id, 
            headers: {"token": localStorage.getItem('token')},
            success: function(result){
                console.log("success")
            }
        })
    })

    $("#todo-edit").click(function(){
        var id = $("#dataId").val()
        console.log(id)
        $.ajax({
            type: "DELETE", 
            url: "http://localhost:3000/todos/"+id, 
            headers: {"token": localStorage.getItem('token')},
            success: function(result){
                console.log("success")
            }
        })
    })

 </script>

</html>